<div *ngIf="timeAutoComplete == 1" class="mx-4">
  <div *ngIf="timeAutoComplete == 1" class="uppercase dashboard-page-title pt-10">
    NUEVA AUTORIZACIÓN </div>

  <div *ngIf="timeAutoComplete == 1" class="pt-3 pb-2 mt-5 ml-1" style="background-color: #F2F2F2">

    <div class="mt-3 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 xl:grid-cols-5">
      <div class="ml-5 mr-3">
        <app-date-picker [group]="authorization" label="Fecha" name="fecha">
        </app-date-picker>
      </div>
      <!-- <app-number-input class="mr-3" [group]="authorization.get('informacionAsegurado')" label="ID Number"
        name='idNumber' placeholder=""></app-number-input> -->
      <div class="mr-3 col-span-2 ml-5 md:ml-0">
        <form [formGroup]="authorization.get('informacionAsegurado')">
          <mat-form-field color="accent" appearance="outline" class="w-full bg-transparente"
            style="font-size: small !important;">
            <mat-label>ID Number</mat-label>
            <input formControlName="idNumber" matInput class="" type="text" [matAutocomplete]="auto"
              placeholder="Juan Juan - 00010002">
            <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
              <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
                {{option}}
              </mat-option>
            </mat-autocomplete>
            <mat-error
              *ngIf="authorization.get('informacionAsegurado').get('idNumber').touched && !authorization.get('informacionAsegurado').get('idNumber').valid">
              Este campo es obligatorio
            </mat-error>
          </mat-form-field>
        </form>
      </div>
      <button style="margin-left: 15px;" *ngIf="ID === null || ID === undefined"
        (click)="searchIdNumber(authorization.get('informacionAsegurado').value.idNumber)" type="submit"
        class="nofocus flex justify-center small-search-button">
        <img src="/assets/iconos/search-icon.svg">
      </button>
    </div>
  </div>

  <div *ngIf="showContent" class="pb-1 mt-4">
    <mat-accordion #matAccordion="matAccordion" name="matAccordion" class="ww-mat-accordion example-headers-align"
      [togglePosition]="'before'">
      <mat-expansion-panel class="ww-mat-expansion" [expanded]="step === 0" (opened)="setStep(0)">
        <mat-expansion-panel-header class="body-13 icon-blue">
          <mat-panel-title>
            Información del Asegurado
          </mat-panel-title>
          <mat-panel-description>
            <div></div>
            <!-- <mat-icon style="color: #FF0000;">warning</mat-icon> -->
            <div *ngIf="showWarningDot(authorization.get('informacionAsegurado'))" class="warning-accordion-dot"></div>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <div class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5">
          <app-input class="mr-3" [group]="authorization.get('informacionAsegurado')" label="Nombres" name='nombres'>
          </app-input>
          <app-input class="mr-3" [group]="authorization.get('informacionAsegurado')" label="Apellidos"
            name='apellidos'></app-input>
          <div class="mr-3">
            <app-input [group]="authorization.get('informacionAsegurado')" label="No. póliza" name='noPoliza'
              placeholder="12345678"></app-input>
          </div>
          <div class="mr-3">
            <app-radio-button [group]="authorization.get('informacionAsegurado')" [options]="generos" name="sexo">
            </app-radio-button>
          </div>
          <div class="mr-3">
            <app-input [group]="authorization.get('informacionAsegurado')" label="Correo" name='correo'
              placeholder="ars.info@seguros.com.do"></app-input>
          </div>
          <div class="mr-3">
            <app-input [group]="authorization.get('informacionAsegurado')" label="Dirección residencia" name='direccion'
              placeholder="Calle 5, Casa #50, ..."></app-input>
          </div>
          <div class="mr-3">
            <app-number-input [group]="authorization.get('informacionAsegurado')" label="Teléfono residencia"
              name='telefonoResidencia' placeholder=""></app-number-input>
          </div>
          <div class="mr-3">
            <app-number-input [group]="authorization.get('informacionAsegurado')" label="Teléfono celular"
              name='telefonoCelular' placeholder=""></app-number-input>
          </div>
          <div class="mr-3">
            <app-number-input [group]="authorization.get('informacionAsegurado')" label="Teléfono oficina"
              name='telefonoOficina' placeholder=""></app-number-input>
          </div>
        </div>

        <div class="grid grid-cols-1 xl:ml-3 mt-5">
          <div class="mr-3 mb-3 sm:mb-3 md:mb-0 lg:mb-0 xl:mb-0 ">
            <app-radio-button [group]="authorization.get('informacionAsegurado')" [options]="seguros" name="otroSeguro"
              (selected)="selectChange($event)">
            </app-radio-button>
          </div>
        </div>

        <!-- INFORMACION DEL SEGURO EXTRA -->
        <div *ngIf="this.authorization.get('informacionAsegurado').get('seguro')"
          class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-5">
          <div class="mr-3">
            <app-input [group]="authorization.get('informacionAsegurado').get('seguro')" label="Nombre compañía"
              name='nombre' placeholder="WorldWide Seguros"></app-input>
          </div>
          <div class="mr-3">

            <app-input [group]="authorization.get('informacionAsegurado').get('seguro')" label="No. póliza"
              name='noPoliza' placeholder="12345678"></app-input>

          </div>
          <div class="mr-3">
            <app-date-picker [group]="authorization.get('informacionAsegurado').get('seguro')" label="Fecha de emisión"
              name="fecha" [max]="todayDate">
            </app-date-picker>
          </div>
          <div class="mr-3">
            <app-number-input [group]="authorization.get('informacionAsegurado').get('seguro')" label="Suma asegurada"
              name='suma' placeholder="20,000$ USD" min="0"></app-number-input>
          </div>
        </div>

        <mat-action-row class="action-row">
          <button mat-button class="next-button" (click)="nextStep()" type="button">
            Siguiente
          </button>
        </mat-action-row>
      </mat-expansion-panel>

      <mat-expansion-panel class="ww-mat-expansion" [expanded]="step === 1" (opened)="setStep(1)">
        <mat-expansion-panel-header class="body-13 icon-blue">
          <mat-panel-title>
            Información médica
          </mat-panel-title>
          <mat-panel-description>
            <div></div>
            <!-- <mat-icon style="color: #FF0000;">warning</mat-icon> -->
            <div *ngIf="showWarningDot(authorization.get('informacionMedica'))" class="warning-accordion-dot"></div>
          </mat-panel-description>
        </mat-expansion-panel-header>

        <div class="grid grid-cols-1  sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-4">

          <!--  PRIMERA COLUMNA -->
          <div class="mr-12">
            <app-input [group]="authorization.get('informacionMedica')" label="Diagnóstico principal" name='diagnostico'
              placeholder="Dolor de cabeza">
            </app-input>
            <div class="-mr-10" style="max-width: 180px;">
              <app-radio-button (selected)="selectChange($event)" [group]="authorization.get('informacionMedica')"
                [options]="condiciones" name="condicion">
              </app-radio-button>
            </div>
            <app-number-input [group]="authorization.get('informacionMedica')" label="Tiempo probable estadía (días)"
              name="tiempoEstadia">
            </app-number-input>
          </div>

          <!--  SEGUNDA COLUMNA -->
          <div class="mr-12">
            <app-date-picker [group]="authorization.get('informacionMedica').get('primerosSintomas')"
              label="Fecha primeros síntomas" name="fecha" [max]="todayDate">
            </app-date-picker>
            <div class="my-4">
              <label> <strong> Médico tratante: </strong> </label>
            </div>
            <app-input [group]="authorization.get('informacionMedica').get('primerosSintomas')" label="Nombre"
              name="nombreMedico">
            </app-input>
            <app-input [group]="authorization.get('informacionMedica').get('primerosSintomas')" label="Dirección"
              name="direccion">
            </app-input>

            <app-number-input [group]="authorization.get('informacionMedica').get('primerosSintomas')" label="Teléfono"
              name='telefono' placeholder=""></app-number-input>
          </div>

          <!--  TERCERA COLUMNA -->
          <div class="mr-12">
            <app-date-picker [group]="authorization.get('informacionMedica').get('admision')"
              label="Fecha probable admisión" name="fecha">
            </app-date-picker>
            <div class="my-4">
              <label> <strong> Médico que lo refiere: </strong> </label>
            </div>
            <app-input [group]="authorization.get('informacionMedica').get('admision')" label="Nombre"
              name="nombreMedico">
            </app-input>
            <app-input [group]="authorization.get('informacionMedica').get('admision')" label="Dirección"
              name="direccion">
            </app-input>

            <app-number-input [group]="authorization.get('informacionMedica').get('admision')" label="Teléfono"
              name='telefono' placeholder=""></app-number-input>
            <div class="my-4" [formGroup]="authorization.get('informacionMedica')">
              <mat-checkbox formControlName="isMedicalEqual">
                ¿Medico tratante es que refiere? </mat-checkbox>
            </div>
          </div>

          <!--  CUARTA COLUMNA -->
          <div class="mr-12">

            <app-input [group]="authorization.get('informacionMedica')" label="Procedimiento a realizar"
              name='procedimiento' placeholder="Operación ...">
            </app-input>
            <div class="my-4">
              <label> <strong> Centro del servicio: </strong> </label>
            </div>
            <app-input [group]="authorization.get('informacionMedica')" label="Nombre" name="nombreServicio">
            </app-input>
            <!-- <app-input [group]="authorization.get('informacionMedica')" label="Dirección" name="direccion">
            </app-input>

            <app-input [group]="authorization.get('informacionMedica')" label="Teléfono" name='telefono' placeholder="">
            </app-input> -->
          </div>
        </div>
        <mat-action-row class="action-row">
          <button mat-button class="next-button" (click)="nextStep()" type="button">
            Siguiente
          </button>
        </mat-action-row>
      </mat-expansion-panel>

      <mat-expansion-panel class="ww-mat-expansion" [expanded]="step === 2" (opened)="setStep(2)">
        <mat-expansion-panel-header class="body-13 icon-blue">
          <mat-panel-title>
            Archivos adjuntos
          </mat-panel-title>
          <mat-panel-description>
            <div></div>
            <!-- <mat-icon style="color: #FF0000;">warning</mat-icon> -->
            <div *ngIf="showWarningDot(authorization.get('files'))" class="warning-accordion-dot"></div>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <div class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3">
          <!-- <input id="file" type="file" class="form-control"> -->
          <mat-form-field class="mr-3" appearance="outline">
            <mat-label>Informe médico</mat-label>
            <ngx-mat-file-input placeholder="Basic outline placeholder"
              [valuePlaceholder]="fileNameWatcher('medicReport')" (change)="onFileChange($event, 'medicReport')">
            </ngx-mat-file-input>
            <mat-icon style="color: #e2e2e2;" matSuffix>publish</mat-icon>
          </mat-form-field>
          <mat-form-field class="mr-3" appearance="outline">
            <mat-label>Estudios</mat-label>
            <ngx-mat-file-input placeholder="Estudios" [valuePlaceholder]="fileNameWatcher('studies')"
              (change)="onFileChange($event, 'studies')">
            </ngx-mat-file-input>
            <mat-icon style="color: #e2e2e2;" matSuffix>publish</mat-icon>
          </mat-form-field>
          <mat-form-field class="mr-3" appearance="outline">
            <mat-label>Indicacion</mat-label>
            <ngx-mat-file-input placeholder="Indicacion" [valuePlaceholder]="fileNameWatcher('indications')"
              (change)="onFileChange($event, 'indication')">
            </ngx-mat-file-input>
            <mat-icon style="color: #e2e2e2;" matSuffix>publish</mat-icon>
          </mat-form-field>
        </div>
        <mat-action-row class="action-row">
          <button mat-button class="next-button" (click)="nextStep()" type="button">
            Siguiente
          </button>
        </mat-action-row>
      </mat-expansion-panel>
    </mat-accordion>
    <!-- <app-forms-container [titles]="accordionTitles">

      <ng-template #formTemplate>


      </ng-template>

      <ng-template #formTemplate>

      </ng-template>

      <ng-template #formTemplate>

      </ng-template>
    </app-forms-container> -->

  </div>
  <form #form="ngForm" [formGroup]="authorization">
    <div *ngIf="showContent" class="mt-8 mb-4">
      <button mat-button class="cancel-form-button" style="margin-right: 7.5px !important;"
        (click)="formHandler.sendForm(authorization, 'new-authorization', 'cancel')" type="submit">Cancelar</button>
      <button #saveButton name="saveButton" mat-button class="save-button" style="margin-right: 7.5px !important;"
        (click)="sendForm(authorization, 'new-authorization', 'save')" type="submit">Guardar</button>
      <button mat-button class="send-button" (click)="sendForm(authorization, 'new-authorization', 'send', ID)"
        type="submit">Enviar</button>
    </div>
  </form>
</div>
